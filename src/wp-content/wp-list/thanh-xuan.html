<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Locations - Thanh Xuan</title>
        
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <link rel="stylesheet" id="main-css" href="../../index.css">
        <link rel="icon" href="../../wp-content/themes/library/images/favicon.ico">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    </head>
    
    <body class="home">

        <header role="banner">

            <div class="u__wrapper">
                <div class="d-flex align-items-start">

                    <div class="">
                        <div class="fixed-wrapper">

                            <a href="../../index.html">

                                <div class="css-logo">
                                    <div class="lines">
                                        <div class="lines-inner">
                                            <div class="line left"></div>
                                            <div class="line center"></div>
                                            <div class="line right"></div>
                                        </div>
                                    </div>
                                    <div class="bowl-wrapper">
                                        <div class="bowl"></div>
                                    </div>
                                </div>
                                <div class="text-logo">
                                    <img src="../../wp-content/themes/library/images/pho-title.svg" alt="Pho Text Logo"> 
                                </div>

                            </a>

                        </div>
                    </div>

                    <div class="center-links flex-fill nav-hidden">

                        <a href="../../MENUS.html">MENU</a>
                        <a href="../../our-story.html">OUR STORY</a>
                        <a href="../../locations.html">LOCATIONS</a>
                        <a href="../../gallery.html">GALLERY</a>


                    </div>

                    <div class="main-links js__init-width">
                        <div class="fixed-wrapper">

                            <a href="../../locations.html" class="bag-icon"><img src="../../wp-content/themes/library/images/bag-icon.svg" alt="Bag Icon">Book a Table</a>
                            <a href="" class="pin-icon"><img src="../../wp-content/themes/library/images/user-admin(2).svg" alt="Admin Icon" width="25" height="25">Admin Mode</a>                            	
                            <div class="hamburger__wrapper d-inline-block">
                                <div class="hamburger js__open-nav">
                                    <div class="line top"></div>
                                    <div class="line middle"></div>
                                    <div class="line bottom"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            </div>

            <div id="nav-popup" data-colour="#E21837" data-image="#">
                <div class="row align-items-center">
                    <div class="hamburger-wrapper u__wrapper">
                        <div class="hamburger js__open-nav">
                            <div class="line top"></div>
                            <div class="line middle"></div>
                            <div class="line bottom"></div>
                        </div>
                    </div>

                    <div class="col-6 nav-popup__img">
                        <img src="../../wp-content/themes/library/images/popup-img.png" alt=""/>
                    </div>

                    <div class="col-6 nav-popup__links">
                        <nav class="popup-main" role="navigation">
                            <a href="../../MENUS.html">MENU</a>
                            <a href="../../our-story.html">OUR STORY</a>
                            <a href="../../locations.html">LOCATION</a>
                            <a href="">PHO TO GO</a>
                            <a href="">BOOKINGs</a>
                            <a href="">CAREERS</a>
                            <a href="">CONTACT</a>

                        </nav>

                        <ul class="social">
                            <li>
                                <a href="" class="facebook" title=""><i class="fa fa-facebook"></i></a>
                            </li>
                            <li>
                                <a href="" class="instagram" title=""><i class="fa fa-instagram"></i></a>
                            </li>
                            <li>
                                <a href="" class="youtube" title=""><i class="fa fa-youtube"></i></a>
                            </li>
                            <li>
                                <a href="" class="twitter" title=""><i class="fa fa-twitter"></i></a>
                            </li>
                        </ul>

                        <div class="popup-footer">
                            <nav role="navigation">
                                <ul class="nav">
                                    <li><a href="">FAQs</a></li>
                                    <li><a href="">Privacy</a></li>
                                    <li><a href="">GIFT VOUCHERS</a></li>
                                </ul>
                            </nav>

                            <p>&copy; Copyright Pho 2024.</p>
                        </div>
                    </div>
                </div>
            </div>

        </header>

        <div class="site-wrapper front-page">
            <div class="background">
                <div class="background__colour" style="background-color: #201f1f;"></div>

                <div class="background__image">
                    <img src="../../wp-content/themes/library/images/transparent.png">
                </div>
                <!-- <div class="background__gradient"></div> -->
            </div>

            <div class="foreground">
                <main class="content front-page" data-template="front-page" data-site="index.html">
                    <!-- <div class="front-page-gradient"></div> -->

                    <section class="text-columns u__fullScreen js__background-change" data-image="../../wp-content/themes/library/images/background.jpg" >
                        <div class="u__wrapper row align-items-center justify-content-center">
                        
                            <div class="restaurant-display text col-md-6">
                                <div class="image-wrapper u__imgBorder">
                                    <div class="inner">
                                        <img src="https://content.phocafe.co.uk/wp-content/uploads/2024/10/Baker-Street-scaled.jpg" alt="" class="location-background">

                                        <div class="image__overlay c__location-card">
                                            <div class="white-background"><p>Thanh Xuan</p></div>

                                            <div class="c__location-address" style="height: 53.4285px;">
                                                <img src="../../wp-content/themes/library/images/pin-icon.svg" alt="Location Icon" class="c__location-icon">
                                                <p class="location-description" style="height: 33.7054px; transform: translate(0px, -9.7143px);">72A, D.Nguyen Trai, Thanh Xuan, Ha Noi.</p>
                                            </div>
                                            <div class="c__location-phone align-items-center justify-content-center">
                                                <img src="../../wp-content/themes/library/images/phone.svg" alt="Phone Icon" class="c__location-icon">
                                                <p class="location-description" style="height: 24.5626px; transform: translate(0px, -12.5715px);">0123456789</p>
                                            </div>
                                            <div class="c__location-openingTimes align-items-center justify-content-center" style="height: 94.5714px; transform: translate(0px, -16.5714px);">
                                                <img src="../../wp-content/themes/library/images/clock.svg" alt="Clock Icon" class="c__location-icon" style="width: 50px; height: 50px;">
                                                <p class="location-description" style="font-size: 13px; height: 53.125px; transform: translate(0px, -5.14282px);";">Sunday to Thursday 9am-21pm <br> Friday & Saturday 9am-22pm</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="text col-md-6 ">
                                <div class="booking-container">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th onclick="sortTable('booking_id')">Booking ID <i id="icon-booking_id" class="fa-solid fa-sort"></i></th>
                                                <th onclick="sortTable('date')">Date <i id="icon-date" class="fa-solid fa-sort"></i></th>
                                                <th onclick="sortTable('time')">Time <i id="icon-time" class="fa-solid fa-sort"></i></th>
                                                <th onclick="sortTable('people')">Number of people <i id="icon-people" class="fa-solid fa-sort"></i></th>
                                            </tr>
                                        </thead>
                                        <tbody class="booking-table-body">
                                            <tr>
                                                <td colspan="4">Đang tải dữ liệu...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </section>


                    <div class="newsletter-wrapper col-12">
                        <div class="newsletter-v2 u__wrapper">
                            <div class="d-flex">
                                <img src="../../wp-content/themes/library/images/notepad.webp" alt="">

                                <div class="newsletter-v2__header">
                                    <label for="EMAIL">NEWS AND OFFERS</label>
                                    <p>Sign up to our newsletter to keep up-to-date with all the latest news and offers</p>
                                </div>
                            </div>
                            <form id="footer__mailing-list__form" name="footer__mailing-list__form" class="signup__form mailing-list__form" novalidate>
                                <div class="row">   
                                    <div class="col-md-4">
                                        <input type="text" value="" name="first_name" class="mailing-list__first-name input-first-name" id="footer__mailing-list__first-name"  placeholder="Type your first name*" required>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="text" value="" name="last_name" class="mailing-list__last-name input-last-name" id="footer__mailing-list__last-name" placeholder="Type your last name*" required>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="email" value="" name="to_email" class="mailing-list__email input-email" id="footer__mailing-list__email"  placeholder="Type your email address*" required>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="date" value="" name="dob" class="mailing-list__dob input-dob empty" id="footer__mailing-list__dob"  placeholder="Type your D.O.B">
                                    </div>
                                    <div class="col-md-4">
                                        <input type="text" value="" name="phone_number" class="mailing-list__phone-number input-phone-number" id="footer__mailing-list__phone-number" placeholder="Type your phone number*" required>
                                    </div>  
                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="checkbox_holder">
                                                <input type="checkbox" value="" name="PRIVACY" class="mailing-list__privacy" id="footer__mailing-list__privacy" required>
                                                <p>By signing up you are agreeing to receive marketing updates from Pho.</p>                                            </div>
                                            <button type="submit" id="footer__mailing-list__submit_v2" class="button input-submit mailing-list__submit">Submit</button>
                                            <p class="error">Please agree to the privacy policy</p>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                </main>
            </div>
        </div>

        <footer>
            <div class="u__wrapper top">
                <nav role="navigation">
                    <ul class="nav footer-nav">
                        <li><a href="">Careers</a></li>
                        <li><a href="">FAQs</a></li>
                        <li><a href="">Privacy</a></li>
                        <li><a href="">Gift Vouchers</a></li>
                        <li></li>
                    </ul>
                </nav>
                <div class="social">
                    <ul>
                        <li><a href="" class="facebook" title=""><i class="fa fa-facebook"></i></a></li>
                        <li><a href="" class="instagram" title=""><i class="fa fa-instagram"></i></a></li>
                        <li><a href="" class="youtube" title=""><i class="fa fa-youtube"></i></a></li>
                        <li><a href="" class="twitter" title=""><i class="fa fa-twitter"></i></a></li>
                    </ul>
                </div>
            </div>

            <div class="u__wrapper">
                <div class="footer__bottom | d-flex align-items-center justify-content-between">
                    <p>&copy; Copyright Pho 2024.</p>
                </div>
            </div>
        </footer>

        <div id="loading-logo">
			<div class="css-logo loading">
				<div class="lines">
					<div class="lines-inner">
						<div class="line left"></div>
						<div class="line center"></div>
						<div class="line right"></div>
					</div>
				</div>
				<div class="bowl-wrapper">
					<div class="bowl"></div>
				</div>
			</div>
		</div>

        <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
        <script type="text/javascript">
            (function(){
                emailjs.init("2tUcc_rPhb5QtRfIM");
            })();
        </script>

        <!-- Customers Newsletter -->
        <script>
            document.getElementById("footer__mailing-list__form").addEventListener("submit", async function (event) {
                event.preventDefault();

                const firstName = document.getElementById("footer__mailing-list__first-name").value;
                const lastName = document.getElementById("footer__mailing-list__last-name").value;
                const email = document.getElementById("footer__mailing-list__email").value;
                const dob = document.getElementById("footer__mailing-list__dob").value;
                const phoneNumber = document.getElementById("footer__mailing-list__phone-number").value;
                const privacyAgreed = document.getElementById("footer__mailing-list__privacy").checked;

                if (!privacyAgreed) {
                    alert("Please agree to the privacy policy.");
                    return;
                }

                const customerData = {
                    first_name: firstName,
                    last_name: lastName,
                    email: email,
                    dob: dob || null,
                    phone_number: phoneNumber,
                    privacy_agreed: privacyAgreed
                };

                try {
                    const response = await fetch("http://localhost:3000/customers", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(customerData)
                    });

                    const result = await response.json();
                    console.log("Database response:", result);

                    // Gửi email sau khi lưu database thành công
                    const form = document.getElementById("footer__mailing-list__form");
                    await emailjs.sendForm("service_2pzma96", "template_u7pqlex", form);

                    alert("Thank you for signing up!");
                } catch (error) {
                    console.error("Error:", error);
                    alert("Failed to submit form. Please try again.");
                }
            });
        </script>
        <script>
                function downloadInvoice(id) {
                    window.location.href = `http://localhost:3000/invoice/${id}`;
                }
        </script>

        <!-- <script>
            document.addEventListener("DOMContentLoaded", async () => {
                const branchId = 1; // Chỉ lấy dữ liệu của chi nhánh Thanh Xuân (branch_id = 1)
                const bookingsContainer = document.querySelector(".booking-items");

                try {
                    const response = await fetch("http://localhost:3000/booked-tables/1");
                    
                    if (!response.ok) throw new Error("Không thể lấy dữ liệu");

                    const bookedTables = await response.json();

                    if (bookedTables.length === 0) {
                        bookingsContainer.innerHTML = "<p>Không có bàn nào được đặt.</p>";
                        return;
                    }

                    bookingsContainer.innerHTML = bookedTables
                        .map(table => `
                            <div class="booking-item">
                                <p><strong>Booking ID:</strong> ${table.booking_id}</p>
                                <p><strong>Ngày:</strong> ${table.date}</p>
                                <p><strong>Giờ:</strong> ${table.time}</p>
                                <p><strong>Số người:</strong> ${table.people}</p>
                            </div>
                        `)
                        .join("");
                } catch (error) {
                    console.error("Lỗi khi lấy danh sách booked tables:", error);
                    bookingsContainer.innerHTML = "<p>Lỗi khi tải dữ liệu.</p>";
                }
            });
        </script> -->

        <!-- <script>
            document.addEventListener("DOMContentLoaded", async () => {
                const branchId = 1; // Lấy dữ liệu của chi nhánh Thanh Xuân
                const bookingsContainer = document.querySelector(".booking-grid");
        
                try {
                    const response = await fetch("http://localhost:3000/booked-tables/1");
                    
                    if (!response.ok) throw new Error("Không thể lấy dữ liệu");
        
                    const bookedTables = await response.json();
        
                    if (bookedTables.length === 0) {
                        bookingsContainer.innerHTML = "<p style='text-align:center;'>Không có bàn nào được đặt.</p>";
                        return;
                    }
        
                    bookingsContainer.innerHTML = bookedTables
                        .map(table => `
                            <div class="booking-item">
                                <p><strong>Booking ID:</strong> ${table.booking_id}</p>
                                <p><strong>Ngày:</strong> ${table.date}</p>
                                <p><strong>Giờ:</strong> ${table.time}</p>
                                <p><strong>Số người:</strong> ${table.people}</p>
                            </div>
                        `)
                        .join("");
                } catch (error) {
                    console.error("Lỗi khi lấy danh sách booked tables:", error);
                    bookingsContainer.innerHTML = "<p style='text-align:center; color:red;'>Lỗi khi tải dữ liệu.</p>";
                }
            });
        </script> -->

        <script>
                document.addEventListener("DOMContentLoaded", async () => {
                    const branchId = 1;
                    const bookingsTableBody = document.querySelector(".booking-table-body");
                    let bookedTables = [];
                    let currentSort = { column: "booking_id", order: "desc" };

                    try {
                        const response = await fetch(`http://localhost:3000/booked-tables/${branchId}`);
                        if (!response.ok) throw new Error("Không thể lấy dữ liệu");

                        bookedTables = await response.json();

                        // Sắp xếp mặc định theo Booking ID giảm dần
                        sortAndRender("booking_id", "desc");
                    } catch (error) {
                        console.error("Lỗi khi lấy danh sách booked tables:", error);
                        bookingsTableBody.innerHTML = "<tr><td colspan='4' style='color:red;'>Lỗi khi tải dữ liệu.</td></tr>";
                    }

                    // Hàm định dạng giờ
                    function formatTime(timeString) {
                        if (!timeString) return "N/A";
                        const [hours, minutes] = timeString.split(":");
                        return `${hours}:${minutes}`;
                    }

                    // Hàm sắp xếp và hiển thị
                    function sortAndRender(column, order) {
                        bookedTables.sort((a, b) => {
                            let valA = a[column];
                            let valB = b[column];

                            if (column === "date") {
                                valA = new Date(a.date);
                                valB = new Date(b.date);
                            } else if (column === "time") {
                                valA = a.time;
                                valB = b.time;
                            }

                            return order === "asc" ? (valA > valB ? 1 : -1) : (valA < valB ? 1 : -1);
                        });

                        bookingsTableBody.innerHTML = bookedTables
                            .map(table => `
                                <tr>
                                    <td>${table.booking_id}</td>
                                    <td>${table.date.split("T")[0]}</td>
                                    <td>${formatTime(table.time)}</td>
                                    <td>${table.people}</td>
                                </tr>
                            `)
                            .join("");
                    }

                    // Hàm thay đổi sắp xếp khi click vào tiêu đề cột
                    window.sortTable = function(column) {
                        currentSort.order = currentSort.column === column && currentSort.order === "asc" ? "desc" : "asc";
                        currentSort.column = column;
                        sortAndRender(currentSort.column, currentSort.order);
                    };
                });

        </script>

        <script type="text/javascript" src="https://www.phocafe.co.uk/wp-content/themes/pho-2018/library/dist/js/main.min.js?debug=1728022300" id="main_js-js"></script>  
        <script src="../../booking-app/server.js"></script>
        <script src="../../booking-app/package.json"></script>  
    </body>
</html>